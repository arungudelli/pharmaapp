<h2 mat-dialog-title>Add Invoice</h2>

<mat-dialog-content class="mat-typography">
  <form [formGroup]="editInvoiceForm" autocomplete="off">
    <mat-form-field appearance="outline">
      <mat-label>Distributor Name</mat-label>
      <input
        type="text"
        placeholder="Select Distributor"
        matInput
        formControlName="name"
        [matAutocomplete]="autoDistributor"
      />
      <mat-autocomplete
        autoActiveFirstOption
        #autoDistributor="matAutocomplete"
        (optionSelected)="onSelectDistributor($event.option.value)"
      >
        <mat-option
          *ngFor="let option of filteredDistributorOptions | async"
          [value]="option"
        >
          {{ option }}
        </mat-option>
      </mat-autocomplete>
    </mat-form-field>

    <mat-form-field appearance="outline">
      <mat-label>Phone Number</mat-label>
      <input
        type="text"
        placeholder="Phone Number"
        matInput
        formControlName="phoneNumber"
      />
    </mat-form-field>

    <mat-form-field appearance="outline">
      <mat-label>Bill Number</mat-label>
      <input
        type="text"
        placeholder="Bill Number"
        matInput
        formControlName=""
      />
    </mat-form-field>

    <mat-form-field appearance="outline">
      <mat-label>Bill Date</mat-label>
      <input
        [matDatepicker]="picker"
        placeholder="Bill Date"
        matInput
        formControlName=""
      />
      <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
      <mat-datepicker #picker></mat-datepicker>
    </mat-form-field>

    <ng-container formArrayName="invoiceRows">
      <table
        #table
        mat-table
        [dataSource]="invoiceDatasource"
        class="mat-elevation-z8"
      >
        <!-- columns -->
        <ng-container [matColumnDef]="col.key" *ngFor="let col of columnSchema">
          <th mat-header-cell *matHeaderCellDef>{{ col.label }}</th>
          <td
            mat-cell
            *matCellDef="let element; let i = index"
            [formGroup]="element"
          ></td>
        </ng-container>

        <!-- row headers & row definitions -->
        <tr mat-header-row *matHeaderRowDef="invoiceColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: invoiceColumns"></tr>

        <!-- pagination -->
        <mat-paginator
          [pageSizeOptions]="[5, 25, 50, 75]"
          aria-label="select page of invoice"
        ></mat-paginator>
      </table>
    </ng-container>

    <button
      class="button-add-row"
      color="primary"
      mat-raised-button
      type="submit"
      (click)="addRow()"
    >
      Add Row
    </button>
    <br />

    <mat-form-field appearance="outline">
      <mat-label>Amount</mat-label>
      <input
        type="text"
        placeholder="amount"
        matInput
        formControlName="amount"
      />
    </mat-form-field>

    <mat-form-field appearance="outline">
      <mat-label>Total Discount</mat-label>
      <input
        type="text"
        placeholder="Total Discount"
        matInput
        formControlName="totalDiscount"
      />
    </mat-form-field>

    <mat-form-field appearance="outline">
      <mat-label>Actual Amount</mat-label>
      <input
        type="text"
        placeholder="Actual Amount"
        matInput
        formControlName="actualAmount"
      />
    </mat-form-field>
  </form>
</mat-dialog-content>

<mat-dialog-actions align="end">
  <button mat-button mat-dialog-close>Cancel</button>
  <button
    color="primary"
    mat-raised-button
    type="submit"
    [mat-dialog-close]="true"
  >
    Save
  </button>
</mat-dialog-actions>
